# GIS 수정의뢰 등록 API(스마트GIS)

@PostMapping(path = "/api/gischg", params = "from=smart")

## Request 

MobileUserInfo mobUserInfo,  
List<MultipartFile> attachFiles,  
SmartGisChangeRequest request


## Service 시작 
gisChangeService.requestSmartGisChange(attachFiles, request)

1. 도면 Update 

``` java
Tuple2<File, byte[]> attachFile = getTempFileFromBase64(chgReq.getBlueprintDraftDesc());
```

``` java
private Tuple2<File, byte[]> getTempFileFromBase64(String base64) {  
    Tuple2<String, byte[]> fileInfo = Base64ImgConverter.convertToImage(base64);  
    return Tuple.of(tempStorage.save(fileInfo._2, "GC", fileInfo._1()), fileInfo._2());  
}
```

Base64ImgConverter.convertToImage(base64) -> base64 문자열을 이미지 파일로 변환 
Tuple2<String, byte[]> -> String : 확장자 문자열 / Byte[] : 이미지 파일의 바이트 배열 

return Tuple.of(tempStorage.save(fileInfo._2, "GC", fileInfo._1()), fileInfo._2());


```Java
public File save(byte[] bytes, String prefix, String ext) {  
    return saveInternal(prefix, ext,  
          targetFile -> {  
             try {  
                FileCopyUtils.copy(bytes, targetFile);  
             } catch (IOException e) {  
                throw new TmpeFileStorageException(e);  
             }  
          });  
}
```


# JOIN

## 특정 기간동안 대여 가능한 자동차들의 대여비용 구하기 (Lv4)

``` SQL
select car_id
     , CAR_TYPE
     , round(daily_fee*30*(1-discount_rate*0.01)) as FEE
from CAR_RENTAL_COMPANY_CAR c
join CAR_RENTAL_COMPANY_DISCOUNT_PLAN p using (car_type)
where car_type in ('세단', 'SUV')
and DURATION_TYPE = '30일 이상'
and car_id not in (
                    select car_id 
                    from CAR_RENTAL_COMPANY_RENTAL_HISTORY 
                    where END_DATE > '2022-11-01'
                      and START_DATE < '2022-11-30' 
                  )
having fee >= 500000 and fee <= 2000000
order by daily_fee desc, c.car_type, c.car_id desc;
```

**실행 순서**

> 1. From CAR_RENTAL_COMPANY_CAR 과 CAR_RENTAL_COMPANY_DISCOUNT_PLAN를 CAR_TYPE 기준으로 조인
> 2. WHERE 절 
> 3. SELECT 절 
> 4. HAVING 절
> 5. ORDER BY 절

* `fee >= 500000 and fee <= 2000000 ` 를 `HAVING` 절에 작성한 이유는 별칭을 사용하기 위해서다. 

```sql
and round(daily_fee*30*(1-discount_rate*0.01)) >= 500000 
and round(daily_fee*30*(1-discount_rate*0.01)) <= 2000000
```

- select 절이 where 절 보다 실행순서가 빠르기 때문에 별칭을 사용할 수 없으므로 where 절에 넣고 싶다면 위와 같이 별칭 없이 코드를 작성하면 된다. 


## 5월 식품들의 총매출 조회하기


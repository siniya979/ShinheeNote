
`JwtProvider` : JWT 토큰 생성 및 검증 담당 

- JWT 생성 : 사용자의 인증 정보나 권한 정보 등을 기반으로 JWT 토큰 생성. 이때, 사용자의 식별 정보와 필요한 클레임(claim)을 토큰에 추가한다. 예를 들어, 사용자의 아이디나 권한 정보를 클레임으로 추가할 수 있다. 

- JWT 서명 : 생성된 JWT에 서명을 추가하여 변조를 방지한다. 서명은 비밀 키를 사용하여 생성하며, 이를 통해 토큰의 유효성을 검증할 수 있다. 

- JWT 검증 : 수신된 JWT의 서명을 검증하여 토큰의 유효성을 확인한다. 클라이언트가 보낸 요청의 인증을 수행하는데 사용한다. 검증 과정에서 토큰의 만료 여부, 서명의 일치 여부 등을 확인한다 

> 클레임(Claim) : 토큰에 포함되는 정보. 클레임은 Key-value 형태이며, 토큰에 사용자에 대한 추가적인 정보를 포함시킨다. JWT 의 PayLoad 가 Claim 을 포함한다. 이들은 base64로 인코딩된 형태로 토큰에 포함된다. 
> 
> 1. 등록된 클레임(Registered Claim) 
> 	토큰의 내용을 설명하는데 사용되는 클레임. 토큰의 발급자(iss), 만료 시간(exp), 발급 시간(iat) 등이 포함될 수 있다. 
> 2. 공개 클레임 (Public Claim)
>    사용자가 직접 정의하는 클레임. 충돌을 피하기 위해 네임스페이스를 추가해야한다. 예를 들어 사용자의 이름, 이메일 주소 등이 해당한다. 
> 3. 비공개 클레임(Private Claim) 
>    사용자 정의 클레임, 토큰 발급자와 토큰 소비자 사이에 사전에 협의된 내용을 포함시킬 수 있다. 


`SecurityFilterChain` : Spring Security에서 보안 필터 체인을 정의하는 인터페이스. 해당 인터페이스를 구현하여 보안 구성을 정의하고, 웹 요청에 대한 필터 체인을 구축할 수 있다. 주로 `HttpSecurity`를 사용하여 설정된 보안 규칙을 포함하고 있다.

```java 

 @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http.httpBasic().disable()
            .csrf().disable()
            .formLogin(login -> login
                .loginPage("http://localhost:3000/signin")
                .defaultSuccessUrl("http://localhost:3000/")
                .permitAll()
                )
                
        http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
            .and()
                .authorizeHttpRequests()
                .requestMatchers("/static/**").permitAll()
                .requestMatchers("/auth/**").permitAll()
                .anyRequest().authenticated()
                .and().addFilterBefore(jwtVerificationFilter(), UsernamePasswordAuthenticationFilter.class);

        http.exceptionHandling().authenticationEntryPoint(authdenticationEntryPoint)
                                .accessDeniedHandler(accessDeniedHandler);

        return http.build();
    }
```

`http.httpBasic().disable()` : HTTP 기본 인증 비활성화. 실제 운영환경에서는 보안상의 이유로 HTTP 기본 인증을 사용하지 않는 것이 일반적. 대신 OAuth2 등과 같은 보다 안전한 인증 방식으로 구현하여 사용. 

`.csrf().disable()` : CSRF(Cross-Site Request Forgery) 보호 기능을 비활성화. 

> CSRF 공격은 사용자가 의도하지 않은 요청을 악의적인 웹 사이트에서 전송하여 해당 요청을 실행하도록 유도하는 공격입니다. 이를 방지하기 위해 Spring Security는 기본적으로 CSRF 토큰을 사용하여 요청을 검증하고, 이를 통해 악의적인 요청을 차단한다. 
> 
> 그러나 애플리케이션이 API 서버이거나, 클라이언트와 서버 간의 신뢰된 연결만을 사용하는 경우에는 CSRF 공격이 발생할 가능성이 낮을 수 있다. 

```java
.formLogin(login -> login
    .loginPage("로그인 페이지 url")
    .defaultSuccessUrl("로그인 성공 후 리다렉트 url")
    .permitAll() // 로그인 페이지 url 은 모든 클라이언트 허용 
)
```

```java
http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)
	.and()
    .authorizeHttpRequests()
    .requestMatchers("/static/**").permitAll()
    .requestMatchers("/auth/**").permitAll()
    .anyRequest().authenticated()
    .and().addFilterBefore(jwtVerificationFilter(), UsernamePasswordAuthenticationFilter.class);

http.exceptionHandling().authenticationEntryPoint(authdenticationEntryPoint)
    .accessDeniedHandler(accessDeniedHandler);
```

`http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS)`
세션 관리 정책을 설정하여 세션을 "STATELESS"  상태로 관리하도록 지정한다. 세션을 서버에 저장하지 않고, 클라이언트가 서버로부터 받은 토큰 등을 이용하여 모든 요청을 새롭게 인증하는 방식이다. 

> [Stateful/Stateless](https://inpa.tistory.com/entry/WEB-%F0%9F%93%9A-Stateful-Stateless-%EC%A0%95%EB%A6%AC)



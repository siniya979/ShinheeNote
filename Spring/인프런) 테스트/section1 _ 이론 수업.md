

# 테스트의 필요성과 테스트 3분류

## **필요성** 
레거시 코드란, 단순히 테스트 루틴이 없는 코드다.  ( 마이클 C.페더스 )
잘 돌아가던 코드가 배포로 인해 동작하지 않는 상황을 Regression이라 한다. 

**테스트와 SOLID는 상호 보완적이다.** 
![](https://i.imgur.com/zzKEqBY.png)


**S : Single Responsibility principle 단일 책임 원칙**
테스트는 명료하고 간단하게 작성해야하기 때문에, 단일 책임 원칙을 지키게 된다. 
테스트가 너무 많아져서 이게 무슨 목적의 클래스이니 눈에 안들어오는 지점이 생긴다.
이 때가 클래스를 분할해야 하는 시점, 그러면서 책임이 자연스럽게 분배 된다. 

**O : Open/Closed principle 개방 폐쇄 원칙** 
테스트 컴포넌트와 프로덕션 컴포넌트를 나눠 작업하게 되고 필요에 따라 이 컴포넌트를 자유자재로 탈부착이 가능하도록 개발하게 된다. 

**L : Liskov Subsitution principle 리스코프 치환 원칙** 
즉 슈퍼 클래스의 계약을 서브 클래스가 제대로 치환하고 있는지 확인하라! 
이상적으로 테스트는 모든 케이스에 대해 커버하고 있으므로, 서브 클래스에 대한 치환 여부를 테스트가 알아서 판단해준다. 

**I : Interface segregation principle 인터페이스 분리 원칙** 
테스트는 그 자체로 인터페이스를 직접 사용해볼 수 있는 환경. 불필요한 의존성을 실제로 확인할 수 있는 샌드박스 
 
**D : Dependency Inversion principle 의존성 역전 원칙** 
가짜 객체를 이용하여 테스트를 작성하려면, 의존성이 역전되어 있어야 하는 경우가 생김 



## 테스트 3분류 

전통적인 테스트 3분류 
![](https://i.imgur.com/U5IL7fO.png)

헷갈리고 개발자마다 정의가 다름 


![](https://i.imgur.com/6Mmk89P.png)

**소형 테스트** 
- 단일 서버 
- 단일 프로세스
- 단일 스레드
- 디스크 I/O 사용해서 안됨
- Blocking call 허용 안됨 

**중형 테스트**
- 단일 서버
- 멀티 프로세스
- 멀티스레드 
-> H2 같은 테스트 DB를 사용할 수 있다. 

**대형 테스트**
- 멀티 서버
- E2E(End to End) 테스트 



## 테스트에 필요한 개념 

1. 개념 
**SUT ( System under test )** : 테스트 하려는 대상 
![](https://i.imgur.com/GqE78jD.png)

**BDD ( given - when - then )**

상호 작용 테스트 
: 대상 함수의 구현을 호출하지 않으면서 그 함수가 어떻게 호줄되는지 검증하는 기법 